<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta content="text/html; charset=utf-8" http-equiv="content-type"><title>Numerical integration of light paths in a Schwarzschild metric - theconfused.me</title><meta content="Numerical integration of light paths in a Schwarzschild metric - theconfused.me" property="title"><meta content="Numerical integration of light paths in a Schwarzschild metric - theconfused.me" property="og:title"><meta property="og:description" content="Update: A few people have been asking me for the code for generating these graphs, so I organized some of the old code and uploaded it here: schwarzschild.py.
To find the trajectory of anything in General Relativity, usually you only need the metric tensor, from which you can obtain the geodesic equations. Nevertheless, a common problem that arises in cosmology is that as soon as we depart from the simplest homogeneous models, the task of finding solutions to the geodesic equations quickly becomes an intractable analytical problem."><meta property="og:type" content="article"><meta property="og:url" content="https://theconfused.me/blog/numerical-integration-of-light-paths-in-a-schwarzschild-metric/"><meta property="article:published_time" content="2017-10-14T00:00:00&#43;00:00"><meta name="generator" content="Hugo 0.57.2"><style type="text/css">:root{--main-color:#4c4e4f;--secondary-color:cornflowerblue;--logo-text-color:#fff;--heading-text-color:#4c4e4f;--body-text-color:#4c4e4f;--background-color:#fdfdff}body,html{color:#303030;font-family:Helvetica,Arial,sans-serif;font-size:15px;letter-spacing:.02em}#toc,.post-content{line-height:1.5}h1,h2{font-size:1.5rem}h3,strong{font-size:1rem}h1:focus,h2:focus,h3:focus,h4:focus{outline:0}.main{max-width:650px;margin:0 auto;padding:1rem}.container{position:relative}.logo{font-size:1.5rem;font-weight:600;color:var(--secondary-color)}a{color:inherit;text-decoration:none;transition:.1s color linear,.1s border-color linear}a:hover:not(.logo){color:var(--secondary-color)}.article a{border-bottom:1px solid rgba(48,48,48,.4)}.article a:hover{border-bottom-color:var(--secondary-color)}hr{border:0;border-top:1px dashed rgba(48,48,48,.18)}.gap-top{margin-top:1.65rem}.posts-list{display:flex;margin-top:1rem}.posts-list strong{margin-left:.66rem}.date{min-width:60px;text-align:right}.faded{color:rgba(48,48,48,.4);font-style:italic;font-weight:700}pre{font-size:.9em;padding:10px 20px 10px 20px;overflow:auto;line-height:1.25em}p code{font-weight:700}.message{font-weight:400}@media only screen and (min-width:875px){.main{padding:3rem 1rem;padding:bottom: 5rem}}figure{margin:2em 1em}img{display:block;margin-left:auto;margin-right:auto;box-shadow:1px 1px 2px 2px #bbb;max-width:100%}figure.no-border img{box-shadow:none}figure.img-wide img{margin-left:-100px;margin-right:-100px;max-width:850px}@media (max-width:850px){figure.img-wide img{margin-left:0;margin-right:0;max-width:100%}}figcaption{text-align:center;margin-top:.5em;color:gray}blockquote{border-left-style:solid;border-left-width:1px;border-color:rgba(48,48,48,.18);border-width:.25rem;margin-left:0;margin-top:0;margin-right:0;padding-left:1rem}blockquote p{color:#666;margin-top:0;font-style:italic}blockquote p>cite{text-transform:uppercase;font-style:normal;letter-spacing:.1em;font-size:.875rem;display:block}table{font-size:14px;border-collapse:collapse;margin:2rem auto;padding:0}table tr{border-top:1px solid #ccc;margin:0;padding:0}table tr td[align=center],table tr th[align=center]{text-align:center}table tr td,table tr th{border:1px solid #ccc;text-align:left;margin:0;padding:6px 13px}#toc{position:fixed}#toc>.toc-list{max-width:250px;overflow:hidden;position:fixed;right:2rem}@media (min-width:1200px){#toc>.toc-list{display:block;top:100px}}@media (min-width:1330px){#toc>.toc-list{max-width:300px;right:3rem}}#toc ol{list-style:none}.gray{color:rgba(48,48,48,.4);font-weight:700}</style><link rel="icon" href="https://theconfused.me/favicon.ico" type="image/x-icon"><link href="https://theconfused.me/feed.xml" rel="alternate" type="application/atom+xml" title="theconfused.me"><script type="application/javascript">var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-96137027-1","auto"),ga("send","pageview"))</script><script async src="https://www.google-analytics.com/analytics.js"></script></head><body><div class="main"><div class="container" class="article gap-top-container"><div style="margin-bottom:1.5rem"><a class="logo" href="https://theconfused.me/">theconfused.me</a></div><span class="gray">14 Oct 2017 { <a href="https://theconfused.me/tags/physics">physics</a> }</span><h1>Numerical integration of light paths in a Schwarzschild metric</h1><div class="post-content article"><p><strong>Update</strong>: A few people have been asking me for the code for generating these graphs, so I organized some of the old code and uploaded it here: <a href="https://gist.github.com/lingxz/98cb5261432e46e3edc76eaff1ef6dd0" target="_blank">schwarzschild.py</a>.</p><p>To find the trajectory of anything in General Relativity, usually you only need the metric tensor, from which you can obtain the geodesic equations. Nevertheless, a common problem that arises in cosmology is that as soon as we depart from the simplest homogeneous models, the task of finding solutions to the geodesic equations quickly becomes an intractable analytical problem.</p><p>In this post are some notes of how to perform numerical integration of light paths in the Schwarzschild metric.</p><h2 id="differential-equations-of-orbit">Differential equations of orbit</h2><p>The Schwarzschild metric is one of the most famous solutions to the Einstein field equations, and the line element in this metric (in natural units $c = G = 1$) is given by:</p><p>$$ds^2 = -f(r) dt^2 + \frac{dr^2}{f(r)} + r^2(d\theta^2 + \sin^2 \theta d\phi^2)$$</p><p>We are interested in the trajectory of a light ray in such a metric. Since the metric is spherically symmetric, any light ray that starts with a certain $\theta$ must stay in the same $\theta$ plane, hence we can arbitrarily set $\theta = \pi/2$ and do away with all the $\theta$ terms.</p><p>Light follows a null (lightlike) trajectory given by $ds^2 = 0$. In the absence of external forces, it should also travel along a geodesic. These are governed by the geodesic equations, which can be derived using Euler-Lagrange equations. Due to the symmetry of the metric, applying the Euler-Lagrange equations to the metric gives us two conserved quantities:</p><p>$$f \dot{t} = E = \text{constant}$$</p><p>$$r^2 \dot{\phi} = L = \text{constant}$$</p><p>where an overdot refers to derivative with respect to an affine parameter $\lambda$.</p><p>Using the null condition, we have</p><p>$$f\dot{t}^2 - \frac{\dot{r}^2}{f} - r^2\dot{\phi}^2 = 0$$</p><p>This can be expressed in terms of $\dot{r}$, and differentiating again gives the second-order differential equation for $r$:</p><p>$$\ddot{r} = \frac{L^2(r - 3M)}{r^4}$$</p><p>This can be easily converted into a first-order differential equation to be solved numerically by setting a variable $p = \dot{r}$. So we have these 3 differential equations to compute numerically:</p><p>$$\dot{r} = p$$</p><p>$$\dot{p} = \frac{L^2(r - 3M)}{r^4}$$</p><p>$$\dot{\phi} = \frac{L}{r^2}$$</p><p>(This can of course be solved analytically in the weak gravity limit, which gives the light bending equation $\Delta \phi = 4M/b$ where $b$ is the impact parameter.)</p><h2 id="initial-conditions">Initial conditions</h2><p>In principle, we need the initial values of $r$, $p$, and $\phi$ to start the numerical simulation. However, if we fix the incoming velocity to be horizontal, then we would only need to specify the initial $x_0$ and $y_0$ coordinates.</p><p>We can take $\dot{t} = 1$ for convenience. The initial conditions can then be derived from the null condition and they are as follows:</p><p>$$r = \sqrt{x_0^2 + b^2}$$</p><p>$$\phi = \cos^{-1} \left ( \frac{x_0}{r} \right )$$</p><p>$$\dot{r} = p = \cos{\phi}$$</p><p>$$L = r^2 \dot{\phi} = r \sqrt{1 - \dot{r}^2}$$</p><p>Then, the only free parameters to specify $b$ and $x_0$, in addition to mass.</p><h2 id="graphs">Graphs</h2><p>For a mass of $M = 1$ (corresponding to Schwarzschild black hole radius of 2), this is a plot of the trajectories with different impact parameters $b$:</p><figure><img src="https://theconfused.me/img/visualization_trans.png" title="Light rays visualization" alt="Light rays visualization"><figcaption></figcaption></figure><p>And they do fit quite well with the theoretical deflection angle $4M/b$ for large impact parameters:</p><figure><img src="https://theconfused.me/img/deflections.png" title="Numerical deflection angle vs theoretical deflection" alt="Numerical deflection angle vs theoretical deflection"><figcaption></figcaption></figure></div><hr class="gap-top"><div class="faded gap-top message">You can email me at lingyihuu(at)gmail.com if you have any comments, suggestions, or questions. I should respond promptly, because frankly I am not famous enough to be ignoring emails yet.</div><div class="faded gap-top"><a href="https://theconfused.me/" style="margin-right:2rem">&larr; home</a> <a href="https://theconfused.me/blog">&larr; blog archive</a></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.6.0/katex.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/contrib/auto-render.min.js" integrity="sha384-dq1/gEHSxPZQ7DdrM82ID4YVol9BYyU7GbWlIwnwyPzotpoc57wDw/guX8EaYGPx" crossorigin="anonymous"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.6.0/katex.min.css"><script>renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]});for(var inlineMathArray=document.querySelectorAll("script[type='math/tex']"),i=0;i<inlineMathArray.length;i++){var inlineMath=inlineMathArray[i],tex=inlineMath.innerText||inlineMath.textContent;(replaced=document.createElement("span")).innerHTML=katex.renderToString(tex,{displayMode:!1}),inlineMath.parentNode.replaceChild(replaced,inlineMath)}for(var displayMathArray=document.querySelectorAll("script[type='math/tex; mode=display']"),i=0;i<displayMathArray.length;i++){var replaced,displayMath=displayMathArray[i],tex=displayMath.innerHTML;(replaced=document.createElement("span")).innerHTML=katex.renderToString(tex.replace(/%.*/g,""),{displayMode:!0}),displayMath.parentNode.replaceChild(replaced,displayMath)}</script></body></html>